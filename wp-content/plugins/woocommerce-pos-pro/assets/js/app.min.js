!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){(function(a){var b=a.POS,d=b.debug("pro");b.on("before:start",function(){d("starting WooCommerce POS Pro app")}),c(10),c(11),c(13),c(19),c(22);var e=c(24),f=c(33),g=c(41),h=c(46);b.productsApp=new e,b.ordersApp=new f,b.customersApp=new g,b.couponsApp=new h}).call(b,function(){return this}())},,,,function(a,b){a.exports=jQuery},,,,function(a,b){a.exports=_},function(a,b){a.exports=Backbone.Radio},function(a,b,c){(function(a){var b=a.POS,d=c(9),e=b.ReceiptView.prototype.prepare;b.ReceiptView.prototype.prepare=function(a){var b=d.request("entities","get",{type:"option",name:"tax"})||{};return a.store=d.request("entities","get",{type:"option",name:"store"}),e(a,b)}}).call(b,function(){return this}())},function(a,b,c){var d=c(12),e=c(8);d.Stickit.addHandler({selector:'input[data-handler="address"]',onGet:function(a,b){var c=b.selector.match(/\w+\[(\w+)\]/)[1];return e(a).has(c)?a[c]:""},onSet:function(a,b){var c=b.selector.match(/\w+\[(\w+)\]/)[1],d=b.view.model.get(b.observe);return d=d||{},d[c]=a,d}})},function(a,b){a.exports=Backbone},function(a,b,c){(function(a){var b=a.POS,d=b.Entities.Service.prototype.collections;d.customers=c(14),d.coupons=c(16),c(18)}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(15),f=c(9);a.exports=d.DualCollection.extend({model:e,name:"customers",indexes:[{name:"local_id",keyPath:"local_id",unique:!0},{name:"id",keyPath:"id",unique:!0},{name:"status",keyPath:"status",unique:!1},{name:"email",keyPath:"email",unique:!0},{name:"username",keyPath:"username",unique:!0}],initialize:function(){var a=f.request("entities","get",{type:"option",name:"customers"});a&&(this._guest=a.guest,this._default=a.default||a.guest)},getGuestCustomer:function(){return this._guest},getDefaultCustomer:function(){return this._default}})}).call(b,function(){return this}())},function(a,b){(function(b){var c=b.POS;a.exports=c.DualModel.extend({name:"customer",fields:["email","username","first_name","last_name"],validation:function(){var a={email:{required:!0,pattern:"email"}};return c.options.generate_username||(a.username={required:!0}),a}})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(17);a.exports=d.DualCollection.extend({model:e,name:"coupons"})}).call(b,function(){return this}())},function(a,b){(function(b){var c=b.POS;a.exports=c.DualModel.extend({name:"coupon"})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(8),f=c(4),g=["stripe","Striper","s4wc"];a.exports=e.extend(d.Entities.Order.Model.prototype,{processGateway:function(){var a=this.gateways.findWhere({active:!0}).toJSON();if(window.Stripe&&e.contains(g,a.method_id))return this.processStripeGateway(a);this.set({payment_details:a})},processStripeGateway:function(a){var b=new f.Deferred,c=this,d=e.reduce(a,function(a,b,c){if(("number"===c||/-card-number$/.test(c))&&(a.number=b),("cvc"===c||/-card-cvc/.test(c))&&(a.cvc=b),/-card-expiry/.test(c)){var d=b.split("/");a.exp_month=d[0],a.exp_year=d[1]}return"exp-month"===c&&(a.exp_month=b),"exp-year"===c&&(a.exp_year=b),a},{});return window.Stripe.card.createToken(d,function(d,e){e.error&&(a.message=e.error.message,a.paid=!1,c.set({payment_details:a}),b.reject()),a.stripe_token=e.id,c.set({payment_details:a}),b.resolve()}),b}})}).call(b,function(){return this}())},function(a,b,c){c(20)},function(a,b,c){(function(b){var d=b.POS,e=c(9),f=c(8);c(21),a.exports=f.extend(d.POSApp.Cart.Route.prototype,{onEnter:function(){this.openOrders=this.collection.openOrders(),this.openOrders.length>0&&this.showTabs()},showTabs:function(){var a=e.request("tabs","view",{tabs:this.tabsArray()});this.listenTo(this.collection,"change:total",function(b){var c=a.collection.get(b.id);c&&c.set({label:this.tabLabel(b)})}),this.listenTo(a.collection,"active:tab",function(a){this.navigate("cart/"+a.id,{trigger:!0})}),this.layout.getRegion("footer").show(a),this.layout.getRegion("footer").$el.addClass("tabs infinite-tabs")},tabsArray:function(){var a=this.collection.active,b=f.map(this.openOrders,function(b){var c={};return c.id=b.id,c.label=this.tabLabel(b),c.active=b===a,c},this);return b.push({id:"new",label:'<i class="icon-plus"></i>',active:!a}),b}})}).call(b,function(){return this}())},function(a,b,c){(function(a){var b=a.POS,d=c(9),e=b.POSApp.Cart.Views.Customer.prototype,f=c(8);f.extend(e.events,{'click [data-action="add"]':function(){d.request("router","add:customer")},'click [data-action="edit"]':function(){d.request("router","edit:customer",{remote_id:this.model.get("customer.id")})}}),f.extend(e,{onModalSave:function(a){this.saveCustomer(a.toJSON())}})}).call(b,function(){return this}())},function(a,b,c){c(23)},function(a,b,c){(function(b){var d=b.POS,e=c(8);a.exports=e.extend(d.SupportApp.Status.Route.prototype,{databases:["products","orders","cart","customers","coupons"]})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(25);a.exports=d.Router.extend({routes:{products:"list"},list:function(){return new e}})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(26),f=c(27),g=c(28),h=c(9),i=d.Components.Pagination.View;a.exports=d.Route.extend({initialize:function(){this.container=d.layout.getRegion("main"),this.filtered=h.request("entities","get",{type:"filtered",name:"products",perPage:10})},fetch:function(){var a=this.filtered.superset();if(a.isNew())return a.fetch().then(function(){a.fullSync()});this.filtered.resetFilters().removeSort().setPage(0)},render:function(){this.layout=new e,this.listenTo(this.layout,"show",function(){this.showActions(),this.showProducts(),this.showPagination()}),this.container.show(this.layout)},showActions:function(){var a=new f({collection:this.filtered});this.layout.getRegion("actions").show(a)},showProducts:function(){var a=new g({collection:this.filtered});this.layout.getRegion("list").show(a)},showPagination:function(){var a=new i({collection:this.filtered});this.layout.getRegion("footer").show(a)}})}).call(b,function(){return this}())},function(a,b){(function(b){var c=b.POS;a.exports=c.LayoutView.extend({template:"products.panel",tagName:"section",regions:{actions:".products-actions",list:".products-list",footer:".products-footer"},attributes:{class:"panel products products-page"}})}).call(b,function(){return this}())},function(a,b){(function(b){var c=b.POS;a.exports=c.ItemView.extend({template:"products.actions",behaviors:{Filter:{behaviorClass:c.Behaviors.Filter}}})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(29),f=d.ItemView.extend({tagName:"li",className:"empty",template:function(){return d.polyglot.t("messages.no-products")}});a.exports=d.InfiniteListView.extend({childView:e,emptyView:f,childViewContainer:"ul"})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(30),f=c(31);a.exports=d.LayoutView.extend({tagName:"li",className:function(){return this.model.get("type")},template:function(){return'<div class="item"></div><div class="list-drawer"></div>'},regions:{item:".item",drawer:".list-drawer"},onRender:function(){var a=new e({model:this.model});this.listenTo(a,"open:drawer",this.openDrawer),this.listenTo(a,"close:drawer",this.closeDrawer),this.listenTo(a,"toggle:drawer",this.toggleDrawer),this.getRegion("item").show(a)},openDrawer:function(a){a=a||{},a.model=this.model,a.className="variations";var b=new f(a);this.getRegion("drawer").show(b),this.$el.addClass("drawer-open")},closeDrawer:function(){var a=this.getRegion("drawer");a.$el.slideUp(250,function(){a.empty(),a.$el.show()}),this.$el.removeClass("drawer-open")},toggleDrawer:function(a){var b=this.getRegion("drawer"),c=b.hasView();if(c&&a.filter)return b.currentView.filterVariations(a.filter);c?this.closeDrawer():this.openDrawer(a)}})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(4),f=c(8);a.exports=d.FormView.extend({template:"products.list-item",className:"list-row",templateHelpers:function(){var a="variable"===this.model.get("type")?{product_variations:this.model.productVariations()}:{};return a.product_attributes=this.model.productAttributes(),a},ui:{title:'.title strong[contenteditable="true"]',open:'[data-action="expand"]',close:'[data-action="close"]',filter:".title ul.variations li a"},events:{"click @ui.filter":"toggleVariations","click @ui.title":"focusTitle"},triggers:{"click @ui.open":"open:drawer","click @ui.close":"close:drawer toggle:reset"},behaviors:{Numpad:{behaviorClass:d.Behaviors.Numpad},AutoGrow:{behaviorClass:d.Behaviors.AutoGrow},Tooltip:{behaviorClass:d.Behaviors.Tooltip,html:!0}},bindings:{'.title strong[contenteditable="true"]':{observe:"name",events:["blur"]},'input[name="stock_quantity"]':{observe:"stock_quantity",onGet:function(a){return d.Utils.formatNumber(a,"auto")},onSet:d.Utils.unformat,attributes:[{name:"disabled",observe:"managing_stock",onGet:function(a){return!a}}]},'input[name="managing_stock"]':"managing_stock",'input[name="regular_price"]':{observe:"regular_price",onGet:d.Utils.formatNumber,onSet:d.Utils.unformat},'input[name="taxable"]':"taxable",'input[name="sale_price"]':{observe:"sale_price",onGet:d.Utils.formatNumber,onSet:d.Utils.unformat,attributes:[{name:"disabled",observe:"on_sale",onGet:function(a){return!a}}]},'input[name="on_sale"]':"on_sale",'span[data-name="regular_price"]':{observe:"variations",updateMethod:"html",onGet:function(){var a=this.model.getVariations().superset().range("regular_price");return f.map(a,d.Utils.formatMoney).join(" - ")}},'span[data-name="sale_price"]':{observe:"variations",updateMethod:"html",onGet:function(){var a=this.model.getVariations().superset().range("sale_price");return f.map(a,d.Utils.formatMoney).join(" - ")}}},modelEvents:{"change:name":"save","change:stock_quantity":"save","change:regular_price":"save","change:managing_stock":"save","change:taxable":"save","change:sale_price":"save","change:on_sale":"save"},save:function(a,b,c){c=c||b,(c.stickitChange||c.numpadChange)&&this.model.save(a.changed,{remote:!0,patch:!0})},toggleVariations:function(a){a.preventDefault();var b={},c=e(a.target).data("name");c&&(b.filter={name:c,option:e(a.target).text()}),this.trigger("toggle:drawer",b)},focusTitle:function(){this.ui.title.find("strong").focus()}})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(32),f=c(8),g=d.ItemView.extend({tagName:"li",className:"empty",template:"products.empty"});a.exports=d.CollectionView.extend({childView:e,emptyView:g,childViewContainer:"ul",initialize:function(a){a=a||{},this.collection=a.model.getVariations(),this.collection.resetFilters(),this.filterVariations(a.filter)},onShow:function(){this.$el.hide().slideDown(250)},filterVariations:function(a){if(a){a=a||{};var b=function(b){var c=b.getVariationAttributes();return f.any(c,function(b){return b.name===a.name&&void 0===b.option&&f.includes(b.options,a.option)||b.option===a.option||""===b.option})};this.collection.filterBy("variation",b)}}})}).call(b,function(){return this}())},function(a,b){(function(b){var c=b.POS;a.exports=c.FormView.extend({template:"products.list-item",className:"list-row",behaviors:{Numpad:{behaviorClass:c.Behaviors.Numpad},AutoGrow:{behaviorClass:c.Behaviors.AutoGrow},Tooltip:{behaviorClass:c.Behaviors.Tooltip,html:!0}},ui:{title:".title strong"},initialize:function(a){this.listenTo(a.model.parent,{"change:title":function(a,b){this.ui.title.text(b)}})},templateHelpers:function(){return{variation:!0,title:this.options.model.parent.get("title"),attributes:this.model.getVariationAttributes()}},bindings:{'input[name="stock_quantity"]':{observe:"stock_quantity",onGet:function(a){return c.Utils.formatNumber(a,"auto")},onSet:c.Utils.unformat,attributes:[{name:"disabled",observe:"managing_stock",onGet:function(a){return!a}}]},'input[name="managing_stock"]':"managing_stock",'input[name="regular_price"]':{observe:"regular_price",onGet:c.Utils.formatNumber,onSet:c.Utils.unformat},'input[name="taxable"]':"taxable",'input[name="sale_price"]':{observe:"sale_price",onGet:c.Utils.formatNumber,onSet:c.Utils.unformat,attributes:[{name:"disabled",observe:"on_sale",onGet:function(a){return!a}}]},'input[name="on_sale"]':"on_sale"},modelEvents:{"change:stock_quantity":"save","change:regular_price":"save","change:managing_stock":"save","change:taxable":"save","change:sale_price":"save","change:on_sale":"save"},save:function(a,b,c){c=c||b,(c.stickitChange||c.numpadChange)&&this.model.save(a.changed,{remote:!0,patch:!0})}})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(34),f=c(39);a.exports=d.Router.extend({initialize:function(){this.channel.reply({"show:order":function(a){this.execute(this.show,a)}},this)},routes:{orders:"list"},list:function(){return new e},show:function(){return new f}})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(12).Radio,f=c(35),g=c(36),h=c(37),i=d.Components.Pagination.View;a.exports=d.Route.extend({initialize:function(){this.container=d.layout.getRegion("main"),this.filtered=e.request("entities","get",{type:"filtered",name:"orders",perPage:10})},fetch:function(){var a=this.filtered.superset();if(a.isNew())return a.fetch().then(function(){a.fullSync()})},onFetch:function(){this.filtered.resetFilters().setSort("id","desc").setPage(0)},render:function(){this.layout=new f,this.listenTo(this.layout,"show",function(){this.showActions(),this.showOrders(),this.showPagination()}),this.container.show(this.layout)},showActions:function(){var a=new g({collection:this.filtered});this.listenTo(a,{"new:order":function(){this.navigate("cart/new",{trigger:!0})}}),this.layout.getRegion("actions").show(a)},showOrders:function(){var a=new h({collection:this.filtered});this.listenTo(a,{"childview:show:order":function(a,b){b.model.hasRemoteId()?e.request("router","show:order",{local_id:b.model.id}):this.navigate("cart/"+b.model.id,{trigger:!0})},"childview:show:customer":function(a,b){var c=b.model.get("customer_id");e.request("router","edit:customer",{remote_id:c})}}),this.layout.getRegion("list").show(a)},showPagination:function(){var a=new i({collection:this.filtered});this.layout.getRegion("footer").show(a)}})}).call(b,function(){return this}())},function(a,b){(function(b){var c=b.POS;a.exports=c.LayoutView.extend({template:"orders.panel",tagName:"section",regions:{actions:".list-actions",list:".list",footer:".list-footer"},attributes:{class:"panel orders-page"}})}).call(b,function(){return this}())},function(a,b){(function(b){var c=b.POS;a.exports=c.ItemView.extend({template:"orders.actions",className:"form-inline",behaviors:{Filter:{behaviorClass:c.Behaviors.Filter}},ui:{order:'*[data-action="new-order"]',search:'input[type="search"]'},triggers:{"click @ui.order":"new:order"}})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(38),f=d.ItemView.extend({tagName:"li",className:"empty",template:function(){return d.polyglot.t("messages.no-orders")}});a.exports=d.InfiniteListView.extend({childView:e,emptyView:f,childViewContainer:"ul"})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(9);a.exports=d.ItemView.extend({tagName:"li",className:"list-row",template:"orders.list-item",initialize:function(){this.statuses=e.request("entities","get",{type:"option",name:"order_status"})},behaviors:{Tooltip:{behaviorClass:d.Behaviors.Tooltip}},triggers:{'click a[data-action="show"]':"show:order",'click a[data-action="customer"]':"show:customer"},templateHelpers:function(){var a={},b=this.model.get("status");return this.statuses.hasOwnProperty("wc-"+b)?a.status_label=this.statuses["wc-"+this.model.get("status")]:(a.status="open",a.status_label=d.polyglot.t("titles.open")),a.customer_name=this.customerName(),a},customerName:function(){var a=this.model.get("customer")||this.model.get("billing"),b=a.first_name+" "+a.last_name;return""===b.trim()&&(b=a.email),b}})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(9),f=c(40),g=c(4);a.exports=d.Route.extend({initialize:function(){this.collection=e.request("entities","get",{type:"collection",name:"orders"}),this.tax=e.request("entities","get",{type:"option",name:"tax"})||{}},fetch:function(a){a=a||{};var b=this;return this.collection.isNew()?this.collection.fetch().then(function(){return b._fetch(a)}):this._fetch(a)},_fetch:function(a){if(this.model=this.findModel(a),!this.model&&a.remote_id){var b=this.collection.add({id:a.remote_id,status:"completed"});return b.save({},{wait:!0}).then(function(){return b.fetch({remote:!0})})}},onFetch:function(a){a=a||{},this.model||(this.model=this.findModel(a))},findModel:function(a){var b;return a.local_id?b=this.collection.get(a.local_id):a.remote_id&&(b=this.collection.findWhere({id:a.remote_id})),b},render:function(){var a=this;this.layout=new f({model:this.model}),this.listenTo(this.layout,{show:function(){this.showItems(),this.showTotals()}}),e.request("modal","open",this.layout).then(function(b){var c=b.view.getButtons();a.listenTo(c,{"action:print":a.print,"action:email":a.email})})},showItems:function(){var a=new d.POSApp.Receipt.Views.Items({model:this.model,tax_display_cart:this.tax.tax_display_cart});this.layout.list.show(a)},showTotals:function(){var a=new d.POSApp.Receipt.Views.Totals({model:this.model,tax_display_cart:this.tax.tax_display_cart,tax_total_display:this.tax.tax_total_display});this.layout.totals.show(a)},print:function(){e.request("print","print",{template:"receipt",model:this.model})},email:function(){var a=this,b=new d.POSApp.Receipt.Views.Email({order_id:this.model.get("id"),email:this.model.get("customer.email")});e.request("modal","open",b).then(function(b){var c=b.view.getButtons();a.listenTo(c,"action:send",function(c,d){var e=b.view.getRegion("content").currentView.getEmail();a.send(c,d,e)})})},send:function(a,b,c){function d(b){"success"===b.result?a.trigger("state",["success",b.message]):a.trigger("state",["error",b.message])}function f(b){var c=null;b.responseJSON&&b.responseJSON.errors&&(c=b.responseJSON.errors[0].message),a.trigger("state",["error",c])}var h=this.model.get("id"),i=e.request("entities","get",{type:"option",name:"ajaxurl"});a.trigger("state",["loading",""]),g.getJSON(i,{action:"wc_pos_email_receipt",order_id:h,email:c}).done(d).fail(f)}})}).call(b,function(){return this}())},function(a,b){(function(b){var c=b.POS;a.exports=c.LayoutView.extend({template:"pos.receipt.panel",tagName:"section",regions:{list:".list",totals:".list-totals"},className:function(){return"receipt "+this.model.get("status")},initialize:function(){this.modal={header:{title:c.polyglot.t("titles.order")+" #"+this.model.get("order_number")},footer:{buttons:[{action:"print",className:"btn-primary pull-left"},{action:"email",className:"btn-primary pull-left"},{action:"close"}]}}},onShow:function(){this.$(".status").remove(),this.$(".list-actions").remove()}})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(42),f=c(44);a.exports=d.Router.extend({initialize:function(){this.channel.reply({"add:customer":function(a){this.execute(this.add,a)},"edit:customer":function(a){this.execute(this.edit,a)}},this)},routes:{customers:"list"},list:function(){return new e},add:function(){return new f},edit:function(){return new f}})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(12).Radio,f=c(43),g=d.Components.Pagination.View;a.exports=d.Route.extend({initialize:function(){this.container=d.layout.getRegion("main"),this.filtered=e.request("entities","get",{type:"filtered",name:"customers",perPage:10})},fetch:function(){var a=this.filtered.superset();if(a.isNew())return a.fetch().then(function(){a.fullSync()});this.filtered.removeTransforms().setPerPage(10)},render:function(){this.layout=new f.Layout,this.listenTo(this.layout,"show",function(){this.showActions(),this.showCustomers(),this.showPagination()}),this.container.show(this.layout)},showActions:function(){var a=new f.Actions({collection:this.filtered});this.listenTo(a,{add:function(){e.request("router","add:customer")}}),this.layout.getRegion("actions").show(a)},showCustomers:function(){var a=new f.Customers({collection:this.filtered});this.listenTo(a,{"childview:edit:customer":function(a,b){var c=b.model.get("id");e.request("router","edit:customer",{remote_id:c})},"childview:show:order":function(a,b){var c=parseInt(b.model.get("last_order_id"),10);e.request("router","show:order",{remote_id:c})},"childview:show:orders":function(a,b){var c=b.model.get("id");e.request("entities","get",{name:"orders",type:"filtered"}).query("customer_id:"+c),this.navigate("orders",{trigger:!0})}}),this.layout.getRegion("list").show(a)},showPagination:function(){var a=new g({collection:this.filtered});this.layout.getRegion("footer").show(a)}})}).call(b,function(){return this}())},function(a,b){(function(b){var c=b.POS,d={};d.Layout=c.LayoutView.extend({template:"customers.panel",tagName:"section",regions:{actions:".list-actions",list:".list",footer:".list-footer"},attributes:{class:"panel customers-page"}}),d.Actions=c.ItemView.extend({template:"customers.actions",className:"form-inline",behaviors:{Filter:{behaviorClass:c.Behaviors.Filter}},ui:{add:'a[data-action="add"]'},triggers:{"click @ui.add":"add"}}),d.Customer=c.ItemView.extend({template:"customers.list-item",tagName:"li",className:"list-row",behaviors:{Tooltip:{behaviorClass:c.Behaviors.Tooltip}},modelEvents:{change:"render"},ui:{edit:'a[data-action="edit"]',showOrder:'a[data-action="showOrder"]',showOrders:'a[data-action="showOrders"]'},triggers:{"click @ui.edit":"edit:customer","click @ui.showOrder":"show:order","click @ui.showOrders":"show:orders"}}),d.NoCustomer=c.ItemView.extend({tagName:"li",className:"empty",template:function(){return c.polyglot.t("messages.no-customer")}}),d.Customers=c.InfiniteListView.extend({childView:d.Customer,emptyView:d.NoCustomer,childViewContainer:"ul"}),a.exports=d}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(45),f=c(9);a.exports=d.Route.extend({initialize:function(){this.collection=f.request("entities","get",{type:"collection",name:"customers"})},fetch:function(a){this.mergeOptions(a,["remote_id"]);var b=this;return this.collection.isNew()?this.collection.fetch().then(function(){return b._fetch()}):this._fetch()},_fetch:function(){if(this.remote_id){return this.collection.findWhere({id:this.remote_id})?void 0:this.collection.add({id:this.remote_id}).fetch({remote:!0})}},onFetch:function(){this.remote_id&&(this.model=this.collection.findWhere({id:this.remote_id})),this.model||(this.model=this.collection.add({copy_billing_address:!0},{silent:!0})),this.collection.active=this.model},render:function(){var a=this,b=new e({model:this.model});f.request("modal","open",b).then(function(b){var c=b.view.getRegion("footer").currentView;a.listenTo(c,"action:save",a.saveCustomer)})},saveCustomer:function(a){if(!this.model.isValid(!0))return void a.trigger("state",["error",null]);a.trigger("state",["loading",""]),this.model.get("copy_billing_address")&&this.model.set({shipping_address:this.model.get("billing_address")}),this.model.save([],{remote:!0}).done(function(b){var c=b[0];c.trigger("modal:save",c),a.trigger("state",["success",null])}).fail(function(a){var b,c;a.target&&a.target.error&&(b=a.target.error.name,c=a.target.error.message,f.trigger("global","error",{status:b,message:c})),a.responseJSON&&f.trigger("global","error",{jqXHR:a})})}})}).call(b,function(){return this}())},function(a,b){(function(b){var c=b.POS;a.exports=c.FormView.extend({template:"modals.customer-edit",tagName:"form",className:"customer-edit",initialize:function(){var a=this.model.get("id")?"edit":"add",b=c.polyglot.t("titles."+a+"-customer");this.modal={className:"modal-lg",header:{title:b}}},bindings:{'input[name="first_name"]':"first_name",'input[name="last_name"]':"last_name",'input[name="email"]':"email",'input[name="username"]':"username",'input[name="billing_address[first_name]"]':"billing_address",'input[name="billing_address[last_name]"]':"billing_address",'input[name="billing_address[company]"]':"billing_address",'input[name="billing_address[address_1]"]':"billing_address",'input[name="billing_address[address_2]"]':"billing_address",'input[name="billing_address[city]"]':"billing_address",'input[name="billing_address[postcode]"]':"billing_address",'input[name="billing_address[country]"]':"billing_address",'input[name="billing_address[state]"]':"billing_address",'input[name="billing_address[email]"]':"billing_address",'input[name="billing_address[phone]"]':"billing_address",'input[name="shipping_address[first_name]"]':"shipping_address",'input[name="shipping_address[last_name]"]':"shipping_address",'input[name="shipping_address[company]"]':"shipping_address",'input[name="shipping_address[address_1]"]':"shipping_address",'input[name="shipping_address[address_2]"]':"shipping_address",'input[name="shipping_address[city]"]':"shipping_address",'input[name="shipping_address[postcode]"]':"shipping_address",'input[name="shipping_address[country]"]':"shipping_address",'input[name="shipping_address[state]"]':"shipping_address",'input[name="copy_billing_address"]':{observe:"copy_billing_address",onGet:function(a){return this.$("table.shipping-address tbody").toggle(!a),a},onSet:function(a){return this.$("table.shipping-address tbody").toggle(!a),a}}},onRender:function(){this.model.get("id")&&this.$('input[name="username"]').prop("disabled",!0)},onDestroy:function(){this.model.isNew()&&this.model.destroy()}})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(47);a.exports=d.Router.extend({routes:{coupons:"list"},list:function(){return new e}})}).call(b,function(){return this}())},function(a,b,c){(function(b){var d=b.POS,e=c(48),f=c(9),g=d.Components.Pagination.View;a.exports=d.Route.extend({initialize:function(){this.container=d.layout.getRegion("main"),this.filtered=f.request("entities","get",{type:"filtered",name:"coupons",perPage:10})},fetch:function(){var a=this.filtered.superset();if(a.isNew())return a.fetch().then(function(){a.fullSync()});this.filtered.setPage(0)},render:function(){this.layout=new e.Layout,this.listenTo(this.layout,"show",function(){this.showActions(),this.showCoupons(),this.showPagination()}),this.container.show(this.layout)},showActions:function(){var a=new e.Actions({collection:this.filtered});this.layout.getRegion("actions").show(a)},showCoupons:function(){var a=new e.Coupons({collection:this.filtered});this.layout.getRegion("list").show(a)},showPagination:function(){var a=new g({collection:this.filtered});this.layout.getRegion("footer").show(a)}})}).call(b,function(){return this}())},function(a,b){(function(b){var c=b.POS,d={};d.Layout=c.LayoutView.extend({template:"coupons.panel",tagName:"section",regions:{actions:".list-actions",list:".list",footer:".list-footer"},attributes:{class:"panel coupons-page"}}),d.Actions=c.ItemView.extend({template:"coupons.actions",behaviors:{Filter:{behaviorClass:c.Behaviors.Filter}}}),d.Coupon=c.ItemView.extend({tagName:"li",className:"list-row",template:"coupons.list-item"}),d.NoCoupon=c.ItemView.extend({tagName:"li",className:"empty",template:function(){return c.polyglot.t("messages.no-coupons")}}),d.Coupons=c.CollectionView.extend({tagName:"ul",className:"striped",childView:d.Coupon,emptyView:d.NoCoupon}),a.exports=d}).call(b,function(){return this}())}]);